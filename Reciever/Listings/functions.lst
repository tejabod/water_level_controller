C51 COMPILER V9.60.0.0   FUNCTIONS                                                         01/24/2023 22:59:33 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE FUNCTIONS
OBJECT MODULE PLACED IN .\Objects\functions.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE functions.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings
                    -\functions.lst) TABS(2) OBJECT(.\Objects\functions.obj)

line level    source

   1          #include<header.h>
   2          
   3          //void Power_Idle()
   4          //{
   5          //  PCON |= 1 << 0;
   6          //}
   7          //void Power_On()
   8          //{
   9          //    PCON &= ~(1 << 0);
  10          //}
  11          extern unsigned int flow_count; 
  12          
  13          unsigned int delay(unsigned int T_Secs)
  14            {
  15   1          unsigned int i =0;
  16   1          for (i =0;i<(T_Secs*1000)/50;i++)
  17   1          {
  18   2          TR0 =1;      // timer start
  19   2          while(TF0==0);  // check overflow condition
  20   2          TR0 =0;     // Stop Timer
  21   2          TF0 =0;    // Clear flag
  22   2          }
  23   1          return 1;
  24   1        }
  25              
  26          //  void Clr_IntrFlag_T2()
  27          //  {
  28          //    TF2 =0;
  29          //    EXF2 =0;
  30          //  }
  31                
  32            void Enable_SFR()
  33            {
  34   1          //init_uart
  35   1          SCON = 0x50;  // Asynchronous mode, 8-bit data and 1-stop bit
  36   1          TMOD = 0x21;  // Timer1 in Mode2 and Timer0 in Mode1
  37   1          TH1 =  0xFD;  // Load timer value for 9600 baudrate
  38   1          TR1 = 1;      // Turn ON the timer for Baud rate generation
  39   1          //init_uart
  40   1          
  41   1          ES  = 1;      // Enable Serial Interrupt
  42   1          P3 |= 0x0c;   // Configure the INT0 & INT1 pins as Inputs
  43   1          EX0 = 1;      // Enable INT0
  44   1          EX1 = 1;      // Enable INT1
  45   1          //    TH0 = 0x4B;   // Load timer value for 50ms
  46   1          //    TL0 = 0xFD;
  47   1          ET0 = 1;      // Enable Timer0 Interrupt
  48   1          TR0 = 1;      // Enable Timer1 Interrupt
  49   1          EA  = 1;      // Enable Global Interrupt bit will cause failure in compiler memory
  50   1          
  51   1          //T2MOD interrupts
  52   1          ET2 =1;  // enable external interrupt for counter 2 counter by T2 pin input
  53   1          C_T2 =1;   // select counter which 
  54   1      
C51 COMPILER V9.60.0.0   FUNCTIONS                                                         01/24/2023 22:59:33 PAGE 2   

  55   1          //timer registers
  56   1          TH0 = 0X4B;    //initial value for 50ms
  57   1          TL0 = 0XFD;
  58   1          // Counter 2 reg values which will increment with T2 pin
  59   1          TH2 = 0xFF;
  60   1          TL2 = 0xFD;
  61   1          //timer registers
  62   1          
  63   1          PS =1;      // set serial interrupt high priority
  64   1        }
  65            
  66          unsigned int check_tap_water()
  67            {
  68   1          flow_count = 0;
  69   1          EX0 = 1;      // Enable INT0
  70   1          P1_3 = 1;         // keep open tap for water
  71   1          while(flow_count < 400)
  72   1          {
  73   2          while (!INT0);
  74   2          while (INT0);
  75   2          flow_count++;
  76   2          }
  77   1          P1_3 = 0;         // keep tap closed
  78   1          EX0 = 0;      // Disble INT0
  79   1          return 1;
  80   1        }
  81            
  82            
  83          unsigned int check_flow()
  84            {
  85   1          flow_count = 0;
  86   1          EX0 = 1;      // Enable INT0
  87   1          P1_3 =1;         // keep open tap for water
  88   1            while(!delay(10))
  89   1            {
  90   2            while (!INT0);
  91   2            while (INT0);
  92   2            flow_count++;
  93   2            }
  94   1          EX0 = 0;      // Disble INT0
  95   1          P1_3 = 0;         // keep tap closed
  96   1          if(flow_count > 2)
  97   1          {
  98   2          return 1;
  99   2          }
 100   1          else
 101   1          {
 102   2            return 0;
 103   2          }
 104   1        }
 105            


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    198    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.60.0.0   FUNCTIONS                                                         01/24/2023 22:59:33 PAGE 3   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
