C51 COMPILER V9.60.0.0   FUNCTIONS                                                         02/09/2023 22:31:16 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE FUNCTIONS
OBJECT MODULE PLACED IN .\Objects\functions.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE functions.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings
                    -\functions.lst) TABS(2) OBJECT(.\Objects\functions.obj)

line level    source

   1          #include<header.h>
   2          
   3          unsigned int flow_count; 
   4          extern unsigned int hour;
   5          extern unsigned int minute;
   6          extern unsigned int second;
   7          
   8          
   9          //unsigned int delay(unsigned int T_Secs)
  10          //  {
  11          //    unsigned int i =0;
  12          //    for (i =0;i<(T_Secs*1000)/50;i++)
  13          //    {
  14          //    TR0 =1;      // timer start
  15          //    while(TF0==0);  // check overflow condition
  16          //    TR0 =0;     // Stop Timer
  17          //    TF0 =0;    // Clear flag
  18          //    }
  19          //    return 1;
  20          //  }
  21          //    
  22            
  23            
  24          void delay(unsigned int T_Secs)
  25          {
  26   1      unsigned int count=0;
  27   1       while(count!=500*T_Secs)
  28   1        {
  29   2         TMOD=0x01;  //16-bit timer0 selected
  30   2         TH0=0xF8;   // Loading high byte in TH
  31   2         TL0=0xCC;   // Loaded low byte in TL
  32   2         TR0=1;      // Running the timer
  33   2          while(!TF0);   //Checking the timer flag register if it is not equal to 1 
  34   2         TR0 = 0;      // If TF0=1 stop the timer
  35   2         TF0 = 0;      // Clear the Timer Flag bit for next calculation
  36   2         count++;
  37   2        }
  38   1      
  39   1      }
  40            
  41          unsigned int check_flow()
  42            {
  43   1          flow_count = 0;
  44   1          EX0 = 1;      // Enable INT0
  45   1          P1_3 =1;         // keep open tap for water
  46   1          delay(10);
  47   1          second=+10;
  48   1          EX0 = 0;      // Disble INT0
  49   1          P1_3 = 0;         // keep tap closed
  50   1          if(flow_count > 3)
  51   1          {
  52   2          return 1;
  53   2          }
  54   1          else
C51 COMPILER V9.60.0.0   FUNCTIONS                                                         02/09/2023 22:31:16 PAGE 2   

  55   1          {
  56   2            return 0;
  57   2          }
  58   1        }
  59          
  60          
  61          void increment_time() {
  62   1          second++;
  63   1          if (second == 60) {
  64   2              second = 0;
  65   2              minute++;
  66   2              if (minute == 60) {
  67   3                  minute = 0;
  68   3                  hour++;
  69   3                  if (hour == 24) {
  70   4                      hour = 0;
  71   4                  }
  72   3              }
  73   2          }
  74   1      }
  75          
  76          void turn_on_motor_at_6am() {
  77   1          // Check if it is 6am
  78   1          if (hour == 0 && minute == 0 && second == 10) 
  79   1            {
  80   2            if(check_flow())
  81   2            {
  82   3              EX1 = 1;
  83   3              while(!INT1)
  84   3              {
  85   4                increment_time();
  86   4                delay(1);
  87   4                P1_2 = 1;
  88   4              }
  89   3              EX1 = 0;
  90   3              P1_2 = 0;
  91   3            }
  92   2          }
  93   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    201    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
